<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>March 2021 update | Moiva.io Blog</title>
    <meta name="description" content="Migration of API endpoints to Cloudflare workers, more sophisticated cache management, Google Trends chart fixes and more...">
    <link rel="stylesheet" href="/blog/assets/style.16e8d4c2.css">
    <link rel="modulepreload" href="/blog/assets/app.c9d8ac17.js">
    <link rel="modulepreload" href="/blog/assets/2021-03-update-migration-to-cloudflare-workers_index.md.c325f9dc.lean.js">
    
    <script>!window.location.href.endsWith("/")&&!window.location.href.includes("#")&&window.location.assign(window.location.href+"/");</script>
  <link rel="icon" type="image/x-icon" href="/favicon/favicon.ico">
  <meta name="copyright" content="2020-current, Alexey Antipov">
  <meta name="twitter:creator" content="@_aantipov">
  <meta name="twitter:card" content="summary_large_image">
  <script async="true" defer="true" data-domain="moiva.io" src="https://plausible.io/js/plausible.js"></script>
  <meta property="og:description" content="Migration of API endpoints to Cloudflare workers, more sophisticated cache management, Google Trends chart fixes and more...">
  <meta name="twitter:description" content="Migration of API endpoints to Cloudflare workers, more sophisticated cache management, Google Trends chart fixes and more...">
  <meta property="og:image" content="https://moiva.io/images/moiva-head.jpg">
  <meta name="twitter:image" content="https://moiva.io/images/moiva-head.jpg">
  <meta property="og:url" content="https://moiva.io/blog/2021-03-update-migration-to-cloudflare-workers/">
  <meta property="twitter:url" content="https://moiva.io/blog/2021-03-update-migration-to-cloudflare-workers/">
  <link rel="canonical" href="https://moiva.io/blog/2021-03-update-migration-to-cloudflare-workers/">
  <script async="true" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  <meta name="twitter:title" content="March 2021 update | Moiva.io Blog">
  <meta property="og:title" content="March 2021 update | Moiva.io Blog">
  </head>
  <body>
    <div id="app"><div class="antialiased h-full flex flex-col"><div class="myprose flex-grow mb-8"><div class="container flex items-center sm:pt-4 mb-8 md:mb-16" data-v-3964f104><img src="/blog/assets/moiva-head.691f2c38.jpg" alt="Moiva.io logo" width="70" height="70" style="margin:0 20px 0 0;" class="inline md:hidden" data-v-3964f104><img src="/blog/assets/moiva-head.691f2c38.jpg" alt="Moiva.io logo" width="100" height="100" style="margin:0 20px 0 0;" class="hidden md:inline" data-v-3964f104><a href="/blog/" title="Home" class="sm:text-5xl text-4xl" data-v-3964f104> Moiva.io Blog </a></div><article class="container root" data-v-f61783ce><main data-v-f61783ce><div class="mb-2 h-9" data-v-f61783ce><!----></div><h1 data-v-f61783ce>March 2021 update</h1><div style="position:relative;" class="mt-6" data-v-f61783ce><div><p>Hey folks, Alexey is here.</p><p>Here is what I&#39;ve been busy with lately.</p><h2 id="migration-to-cloudflare-workers" tabindex="-1">Migration to Cloudflare Workers <a class="header-anchor" href="#migration-to-cloudflare-workers" aria-hidden="true">#</a></h2><p><a href="https://vercel.com/" target="_blank" rel="noopener noreferrer">Vercel</a> and its serverless functions allowed to quickly bootstrap and develop Moiva. And I&#39;m thankful to the developers at Vercel for that, they do really great job!</p><p>Having said that, the more mature Moiva becomes, the more requirements it has and the more limitations of Vercel&#39;s platform it hits.</p><p>One of the limitations was Moiva&#39;s requirements to serverless functions. It needed more visibility, more efficiency, more sophisticated debugging capabilities, more advanced features.</p><p>One time I came across <a href="https://workers.cloudflare.com/" target="_blank" rel="noopener noreferrer">Cloudflare Workers</a> and it caught my attention, it looked pretty attractive and seemed a mature and sophisticated solution for serverless functions.</p><p>After a bit of analysis, I quickly realized that it&#39;s the thing I needed.</p><p>So I set out to migrate all the api endpoints to Cloudflare Workers. I also implemented more sophisticated cache management tailored to each api endpoint. It took several evenings and mornings to finish it.</p><p>I believe such changes should improve Moiva&#39;s efficiency and it will become more noticeable once more users start using it and the Cache starts working to the full.</p><h2 id="google-trends-chart-fix" tabindex="-1">Google Trends Chart fix <a class="header-anchor" href="#google-trends-chart-fix" aria-hidden="true">#</a></h2><p>When I was doing the major refactoring of Moiva in January-February, I accidentally changed the way Google Trends Chart works - it lost optimization tricks I implemented before. That led to more requests being issued to get data for the chart. As a result, Google blocked Moiva completely and the chart stopped working, most probably it was blocked by the IP address.</p><p><img src="/blog/assets/failed-google-trends-chart.d0900e88.png" alt=""></p><p>I think Google Chart is one of the major metrics in evaluating popularity and I couldn&#39;t afford losing such a metric so easily.</p><p>My first idea was that the planned migration to Cloudflare workers + requests optimization + more advanced caching should fix the problem. But I soon realized that the <a href="https://github.com/pat310/google-trends-api" target="_blank" rel="noopener noreferrer">npm package</a> that I use to communicate with Google Trends can&#39;t be used with Cloudflare Workers. Simply because Cloudflare Workers don&#39;t run NodeJS runtime environment which is required for the package to work.</p><p>That means that I still had to rely on Vercel&#39;s serverless functions which run from the same IP-addresses. After looking into Vercel&#39;s documentation for serverless functions I learned that all Vercel&#39;s functions are executed in the same single region, meaning they probably have the same IP-address. I also learned that recently Vercel changed the default region for serverless functions and now allows existing free developer accounts to do a one-time change of the region. That was exactly what I needed because with the region change comes the change of the IP-addresses.</p><p>I hope the current implementation and cache settings won&#39;t make any trouble to Google and Moiva will continue to provide the valuable data.</p><h2 id="most-popular-tweet-so-far" tabindex="-1">Most popular tweet so far <a class="header-anchor" href="#most-popular-tweet-so-far" aria-hidden="true">#</a></h2><p>While working on Moiva I noticed that <a href="https://preactjs.com/" target="_blank" rel="noopener noreferrer">Preact</a> has a sharp increase in Npm downloads. I made a tweet about it wondering about the reason for that.</p><div class="flex justify-center"><blockquote class="twitter-tweet"><a href="https://twitter.com/_aantipov/status/1367183314256281603">Loading a tweet...</a></blockquote></div><p>The tweet turned to be quite popular with 20k impressions. It was my most popular tweet so far and it even beat all my monthly tweet impressions.</p><h2 id="google-search-results-do-better" tabindex="-1">Google Search results do better <a class="header-anchor" href="#google-search-results-do-better" aria-hidden="true">#</a></h2><p>In Google Search results Moiva didn&#39;t perform well for a while and it concerned me. I did many improvements but nothing really was changing and Google didn&#39;t want to digest my sitemap. Fortunately, the results of the last month bring some hope.</p><p><img src="/blog/assets/google-search.66ad8b53.png" alt=""></p><h2 id="last-but-not-least" tabindex="-1">Last but not least <a class="header-anchor" href="#last-but-not-least" aria-hidden="true">#</a></h2><p>Moiva was featured in the <a href="https://makerwork.substack.com/p/makerwork006" target="_blank" rel="noopener noreferrer">Makerwork</a> newsletter.</p></div></div><div class="mt-8" data-v-f61783ce data-v-2f056962><hr data-v-2f056962><a href="/blog/" title="Home" class="text-2xl" data-v-2f056962>← all posts</a><h2 data-v-2f056962>Subscribe to the monthly newsletter</h2><div id="revue-embed" data-v-2f056962><div class="revue-form-footer" data-v-2f056962> By subscribing, you agree with Revue’s <a target="_blank" href="https://www.getrevue.co/terms" data-v-2f056962>Terms</a> and <a target="_blank" href="https://www.getrevue.co/privacy" data-v-2f056962>Privacy Policy</a>. </div><form action="https://www.getrevue.co/profile/moiva/add_subscriber" method="post" id="revue-form" name="revue-form" target="_blank" data-v-2f056962><div class="revue-form-group" data-v-2f056962><label for="member_email" style="display:none;" data-v-2f056962>Email address</label><input class="revue-form-field" placeholder="Your email address..." type="email" name="member[email]" id="member_email" data-v-2f056962></div><div class="revue-form-actions" data-v-2f056962><input type="submit" value="Subscribe" name="member[subscribe]" id="member_submit" data-v-2f056962></div></form></div></div></main></article></div><footer class="pt-5 my-0 text-base text-white pb-7 font-extralight bg-primary flex-shrink-0" data-v-af44d146><div class="container px-10 antialiased sm:px-24 content" data-v-af44d146><div class="w-full mx-auto lg:w-9/12 xl:w-2/4" data-v-af44d146><div class="flex items-center justify-center mb-4" data-v-af44d146><span data-v-af44d146>Made with</span><span style="margin:0 4px;" data-v-af44d146><svg xmlns="http://www.w3.org/2000/svg" style="width:20px;height:20px;" viewBox="0 0 20 20" fill="currentColor" data-v-af44d146><path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" data-v-af44d146></path></svg></span><span data-v-af44d146>by</span><a class="primary-link" href="https://alexei.me" target="_blank" rel="noopener" style="margin-left:4px;" data-v-af44d146>Alexey Antipov</a></div><div class="flex items-center justify-between text-xl" data-v-af44d146><a class="primary-link" target="_blank" href="/" data-v-af44d146>Moiva.io</a><a class="primary-link" target="_blank" href="/about/" data-v-af44d146>About</a><a class="primary-link" target="_blank" href="/catalog/" data-v-af44d146>Catalog</a><a class="primary-link" href="/blog/" data-v-af44d146>Blog</a></div><div class="flex flex-wrap items-center justify-around mt-6 text-xl" data-v-af44d146><a class="primary-link flex items-center" href="https://github.com/aantipov/moiva" rel="noopener" target="_blank" data-v-af44d146><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 fill-current text-white mr-1" style="max-width:50px;max-height:50px;" role="img" aria-label="GitHub icon" viewBox="0 0 24 24" data-v-af44d146><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" data-v-af44d146></path></svg> GitHub</a><a class="primary-link flex items-center" href="https://twitter.com/_aantipov" target="_blank" rel="noopener" data-v-af44d146><svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 fill-current text-white mr-1" style="max-width:50px;max-height:50px;" role="img" aria-label="Twitter icon" viewBox="0 0 24 24" data-v-af44d146><g data-v-af44d146><path d="M23.643 4.937c-.835.37-1.732.62-2.675.733a4.67 4.67 0 0 0 2.048-2.578a9.3 9.3 0 0 1-2.958 1.13a4.66 4.66 0 0 0-7.938 4.25a13.229 13.229 0 0 1-9.602-4.868c-.4.69-.63 1.49-.63 2.342A4.66 4.66 0 0 0 3.96 9.824a4.647 4.647 0 0 1-2.11-.583v.06a4.66 4.66 0 0 0 3.737 4.568a4.692 4.692 0 0 1-2.104.08a4.661 4.661 0 0 0 4.352 3.234a9.348 9.348 0 0 1-5.786 1.995a9.5 9.5 0 0 1-1.112-.065a13.175 13.175 0 0 0 7.14 2.093c8.57 0 13.255-7.098 13.255-13.254c0-.2-.005-.402-.014-.602a9.47 9.47 0 0 0 2.323-2.41l.002-.003z" data-v-af44d146></path></g></svg> Twitter</a></div></div></div></footer></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"2021-03-update-migration-to-cloudflare-workers_index.md\":\"c325f9dc\",\"2021-04-update-github-stars-chart_index.md\":\"2a4902c3\",\"2021-05-update_index.md\":\"5d29226a\",\"2021-06-update-improved-table-view-seo-fixes_index.md\":\"4e1a7550\",\"2021-07-update-new-metric-status_index.md\":\"d093f526\",\"2021-08-update-share-charts-new-suggestions_index.md\":\"3c801a3c\",\"2021-09-update--actions-in-table-charts_index.md\":\"3f6e5b7e\",\"2021-10-update_index.md\":\"944da027\",\"2021-12-update_index.md\":\"b2812e84\",\"2021-q1-report-end-to-end-testing-frameworks_index.md\":\"7f451f56\",\"2021-q1-report-js-build-tools-bundlers_index.md\":\"b2c45bb6\",\"2021-q1-report-js-jamstack_index.md\":\"30b2739a\",\"2021-q1-report-js-testing-libraries_index.md\":\"f3f99fd7\",\"2021-q1-report-state-management_index.md\":\"96952259\",\"2021-q1-state-of-js-frameworks_index.md\":\"a8881f30\",\"2022-01-update_index.md\":\"dc775965\",\"index.md\":\"c2be3831\",\"the-missing-migration-guide-from-vue-cli-to-vite_index.md\":\"e802a5cf\",\"universal-tool-to-evaluate-discover-compare-software_index.md\":\"39eb1cfe\",\"vercel-serverless-functions-vs-cloudflare-workers_index.md\":\"8e5a506b\"}")</script>
    <script type="module" async src="/blog/assets/app.c9d8ac17.js"></script>
    
  </body>
</html>